{"ast":null,"code":"const MODE_STR = [\"AUTO\", \"CMG\", \"THRUSTER\"];\nexport default {\n  name: \"GncControl\",\n  data() {\n    return {\n      ros: null,\n      mode: null,\n      desiredMode: 0,\n      lastUpdate: \"-\",\n      busy: false,\n      toast: \"\"\n    };\n  },\n  computed: {\n    modeString() {\n      return this.mode === null ? \"---\" : MODE_STR[this.mode] ?? `UNKNOWN(${this.mode})`;\n    }\n  },\n  methods: {\n    connectRos() {\n      this.ros = new window.ROSLIB.Ros({\n        url: process.env.VUE_APP_ROSBRIDGE_URL || \"ws://localhost:9090\"\n      });\n      this.ros.on(\"connection\", () => {\n        const sub = new window.ROSLIB.Topic({\n          ros: this.ros,\n          name: \"/gnc/mode_actuation\",\n          messageType: \"std_msgs/msg/String\"\n        });\n        sub.subscribe(msg => {\n          const s = (msg.data || \"\").toLowerCase();\n          this.mode = s === \"auto\" ? 0 : s === \"cmg\" ? 1 : s === \"thruster\" ? 2 : null;\n          this.lastUpdate = new Date().toLocaleString();\n        });\n      });\n      this.ros.on(\"error\", e => this.toast = `ROS error: ${e}`);\n      this.ros.on(\"close\", () => this.toast = \"ROS connection closed\");\n    },\n    setMode() {\n      if (this.busy) return;\n      this.busy = true;\n      const service = new window.ROSLIB.Service({\n        ros: this.ros,\n        name: \"/gnc/set_mode_actuation\",\n        serviceType: \"space_station_gnc/srv/SetGncModeActuation\"\n      });\n      const map = [\"auto\", \"cmg\", \"thruster\"];\n      const request = new window.ROSLIB.ServiceRequest({\n        mode: map[this.desiredMode] || \"auto\"\n      });\n      service.callService(request, resp => {\n        this.toast = resp.message || (resp.success ? \"Accepted\" : \"Rejected\");\n        this.busy = false;\n      }, err => {\n        this.toast = `Call failed: ${err}`;\n        this.busy = false;\n      });\n    }\n  },\n  mounted() {\n    this.connectRos();\n  }\n};","map":{"version":3,"names":["MODE_STR","name","data","ros","mode","desiredMode","lastUpdate","busy","toast","computed","modeString","methods","connectRos","window","ROSLIB","Ros","url","process","env","VUE_APP_ROSBRIDGE_URL","on","sub","Topic","messageType","subscribe","msg","s","toLowerCase","Date","toLocaleString","e","setMode","service","Service","serviceType","map","request","ServiceRequest","callService","resp","message","success","err","mounted"],"sources":["/home/yuyuqq/ros2_ws/src/space_station_os/space_station_gnc/dashboard-ui/src/views/GncControl.vue"],"sourcesContent":["<template>\n  <div class=\"container\">\n    <h1>GNC Control Mode</h1>\n    <div class=\"card\">\n      <div class=\"row\">\n        <div><strong>Current Mode:</strong> <span>{{ modeString }}</span></div>\n        <div><small>Updated:</small> <span>{{ lastUpdate }}</span></div>\n      </div>\n      <div class=\"row\">\n        <select v-model.number=\"desiredMode\">\n          <option :value=\"0\">AUTO</option>\n          <option :value=\"1\">CMG</option>\n          <option :value=\"2\">THRUSTER</option>\n        </select>\n        <button @click=\"setMode\" :disabled=\"busy\">Set Mode</button>\n      </div>\n      <div v-if=\"toast\" class=\"toast\">{{ toast }}</div>\n    </div>\n  </div>\n</template>\n\n<script>\nconst MODE_STR = [\"AUTO\", \"CMG\", \"THRUSTER\"];\n\nexport default {\n  name: \"GncControl\",\n  data() {\n    return {\n      ros: null,\n      mode: null,\n      desiredMode: 0,\n      lastUpdate: \"-\",\n      busy: false,\n      toast: \"\",\n    };\n  },\n  computed: {\n    modeString() {\n      return this.mode === null ? \"---\" : MODE_STR[this.mode] ?? `UNKNOWN(${this.mode})`;\n    },\n  },\n  methods: {\n    connectRos() {\n      this.ros = new window.ROSLIB.Ros({\n        url: process.env.VUE_APP_ROSBRIDGE_URL || \"ws://localhost:9090\",\n      });\n      this.ros.on(\"connection\", () => {\n        const sub = new window.ROSLIB.Topic({\n          ros: this.ros,\n          name: \"/gnc/mode_actuation\",\n          messageType: \"std_msgs/msg/String\",\n        });\n        sub.subscribe((msg) => {\n          const s = (msg.data || \"\").toLowerCase();\n          this.mode = s === \"auto\" ? 0 : s === \"cmg\" ? 1 : s === \"thruster\" ? 2 : null;\n          this.lastUpdate = new Date().toLocaleString();\n        });\n      });\n      this.ros.on(\"error\", (e) => (this.toast = `ROS error: ${e}`));\n      this.ros.on(\"close\", () => (this.toast = \"ROS connection closed\"));\n    },\n    setMode() {\n      if (this.busy) return;\n      this.busy = true;\n      const service = new window.ROSLIB.Service({\n        ros: this.ros,\n        name: \"/gnc/set_mode_actuation\",\n        serviceType: \"space_station_gnc/srv/SetGncModeActuation\",\n      });\n      const map = [\"auto\", \"cmg\", \"thruster\"];\n      const request = new window.ROSLIB.ServiceRequest({\n        mode: map[this.desiredMode] || \"auto\",\n      });\n      service.callService(\n        request,\n        (resp) => {\n          this.toast = resp.message || (resp.success ? \"Accepted\" : \"Rejected\");\n          this.busy = false;\n        },\n        (err) => {\n          this.toast = `Call failed: ${err}`;\n          this.busy = false;\n        }\n      );\n    },\n  },\n  mounted() {\n    this.connectRos();\n  },\n};\n</script>\n\n<style>\n.container { max-width: 720px; margin: 24px auto; padding: 16px; }\n.card { border: 1px solid #333; border-radius: 8px; padding: 16px; }\n.row { display: flex; gap: 12px; align-items: center; margin-bottom: 12px; }\n.toast { margin-top: 8px; font-size: 0.9rem; }\nbutton { padding: 6px 12px; }\nselect { padding: 6px 10px; }\n</style>\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}